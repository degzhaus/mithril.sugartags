<html>
<head>
	<title></title>
	<script src="mithril.js"></script>
	<script src="mithril.sugartags.js"></script>
	<script src="mithril.template.js"></script>
	<style>
		.hide { display: none; }
	</style>
</head>
<body>

<div id="content"></div>

<!-- Main template (embedded) -->
<script id="list" type="text/mithrill">
	DIV([
		//	User an embedded template
		m.template('listHeader'),
		LABEL([
			INPUT({type: 'checkbox', onclick: data.hideSome}),
			"Hide some"
		]),
		UL( {class: "listy"}, [
			data.links.map(function(link) {
				//	Use a template function
				return m.template(data.listItem, link);
			})
		])
	])
</script>

<!-- Header template (embedded) -->
<script id="listHeader" type="text/mithrill">
	H1("Mithril templates")
</script>


<script>
	var app = {
		model: {
			links: [
				{ href: "#", title: "Link 1", shown: m.prop(true) },
				{ href: "#", title: "Link 2", shown: m.prop(true) },
				{ href: "#", title: "Link 3", shown: m.prop(true) }
			]
		},
		controller: function() {
			var self = this;
			self.links = app.model.links;
			self.hideSome = function(){
				var what = parseInt(Math.random()*3,10);
				self.links[what].shown(!self.links[what].shown());
			};

			//	Inline template for list items
			self.listItem = function(data){
				with(m.sugarTags) {
					return LI({class: data.shown()?"":"hide"},
						A({href: data.href}, data.title)
					)
				};
			};
		},
		view: function(ctrl) {
			return [
				m.template('list', ctrl)
			];
		}
	};

	//initialize
	m.module(document.getElementById("content"), app);
</script>
</body>
</html>
